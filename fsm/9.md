# Задача правильной скобочной последовательности не является регулярной

Пусть существует автомат $B$, который может распознать дать ответ, является ли скобочная последовательность правильной.

Рассмотрим строки, которые состоят из одной или более открывающих скобок. Таких скобочных последовательностей бесконечное число и количество состояний автомата конечно, так что существует состояние автомата, которому соответствует хотя бы 2 открывающие последовательности. Назовём более короткую из них $p$, а более длинную $q$.

Заведём функцию $state$, принимающую ДКА, начальное состояние и строку, которая возвращает состояние, в которое приходит ДКА после прочтения строки.

По ранее сказанному, есть такие $p\neq q$, что $state(B, start, p) = state(B, start, q)$.

Теперь заведём строку $p'$, в которой столько же закрывающих скобок, сколько и открывающих в $p$. Строка $pp'$ будет правильной скобочной последовательностью по определению.

Так как в $p$ меньше символов, чем в $q$, то строка $qp'$ по определению не является правильной скобочной последовательностью.

Если мы запустим $B$ на строке $pp'$ и приостановим после прочтения всех символов из $p$, то ДКА придёт в состояние $state(B, start, p)$. Далее автомат читает $p'$ и приходит в состояние $state(B, state(B, start, p), p'))$

Так как $B$ распознаёт правильные скобочные последовательности, а $pp'$ правильная, то назовём $pp'$ *распознанной*. И так как $state(B, state(B, start, p), p'))=state(B, start, pp'))$, то $state(B, state(B, start, p), p'))$ тоже *распознана*.

Теперь запустим $B$ на $qp'$. Приостановим после прочтения всех символов из $q$. Тогда попадём в состояние $state(B, start, q)$. Далее автомат читает $p'$ и приходит в состояние $state(B, state(B, start, q), p')$. Мы знаем, что $qp'$ не является правильной последовательностью, что значит, что $state(B, start, qp')$ не должно быть *распознано*, из чего следует, что и $state(B, state(B, start, q), p')$ не должно быть *распознано* тоже.

Но состояния $state(B, start, q)$ и $state(B, start, p)$ совпадают, так что $state(B, state(B, start, q), p')$ это то же самое состояние, что и $state(B, state(B, start, p), p')$, которое *распознано*. Противоречие.
$\blacksquare$
